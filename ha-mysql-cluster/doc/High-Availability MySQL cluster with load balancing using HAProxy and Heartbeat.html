<!doctype html><html lang="en"><head><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title data-rh="true">High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-05-17T18:45:26.937Z"/><meta data-rh="true" name="title" content="High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat."/><meta data-rh="true" property="og:title" content="High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat."/><meta data-rh="true" property="twitter:title" content="High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat."/><meta data-rh="true" name="twitter:site" content="@TDataScience"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/40a16e134691"/><meta data-rh="true" property="al:android:url" content="medium://p/40a16e134691"/><meta data-rh="true" property="al:ios:url" content="medium://p/40a16e134691"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes, with load balancing and failover capability based on HAProxy &amp;…"/><meta data-rh="true" property="og:description" content="Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes…"/><meta data-rh="true" property="twitter:description" content="Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes…"/><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/high-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691"/><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/high-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/721/1*-UDKtIOlY9KCgnT0iTIuCg.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/721/1*-UDKtIOlY9KCgnT0iTIuCg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://towardsdatascience.com/@ratibor78"/><meta data-rh="true" name="author" content="Alexey Nizhegolenko"/><meta data-rh="true" name="robots" content="index,follow"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="10 min read"/><meta data-rh="true" name="parsely-post-id" content="40a16e134691"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"/><link data-rh="true" rel="author" href="https://towardsdatascience.com/@ratibor78"/><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/high-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/40a16e134691"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*-UDKtIOlY9KCgnT0iTIuCg.png"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fhigh-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691","dateCreated":"2018-12-03T09:29:33.327Z","datePublished":"2018-12-03T09:29:33.327Z","dateModified":"2019-05-17T18:45:27.174Z","headline":"High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.","name":"High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.","description":"Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes, with load balancing and failover capability based on HAProxy &…","identifier":"40a16e134691","keywords":["Lite:true","Tag:MySQL","Tag:Heartbeat","Tag:Haproxy","Tag:Cluster","Tag:Load Balancing","Topic:Software Engineering","Topic:Data Science","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:3"],"author":{"@type":"Person","name":"Alexey Nizhegolenko","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@ratibor78"},"creator":["Alexey Nizhegolenko"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F330\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fhigh-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691"}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="425" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:fixed}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{flex:0 0 auto}.aq{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.ar{font-style:normal}.as{line-height:20px}.at{font-size:15.8px}.au{letter-spacing:0px}.av{color:rgba(0, 0, 0, 0.54)}.aw{fill:rgba(0, 0, 0, 0.54)}.ax{justify-content:flex-end}.ay{margin-top:16px}.az{margin-bottom:16px}.ba{display:inherit}.bb{max-width:210px}.bc{text-overflow:ellipsis}.bd{overflow:hidden}.be{white-space:nowrap}.bf{display:inline-block}.bg{border:none}.bh{outline:none}.bi{font:inherit}.bj{font-size:16px}.bk{opacity:0}.bl{position:relative}.bm{width:0px}.bn{transition:width 140ms ease-in}.bo{color:inherit}.bp{fill:inherit}.bq{font-size:inherit}.br{border:inherit}.bs{font-family:inherit}.bt{letter-spacing:inherit}.bu{font-weight:inherit}.bv{padding:0}.bw{margin:0}.bx:hover{cursor:pointer}.by:hover{color:rgba(0, 0, 0, 0.9)}.bz:hover{fill:rgba(0, 0, 0, 0.9)}.ca:focus{outline:none}.cb:disabled{cursor:default}.cc:disabled{color:rgba(0, 0, 0, 0.54)}.cd:disabled{fill:rgba(0, 0, 0, 0.54)}.ce{margin-left:16px}.cf{margin-right:10px}.ci{display:none}.ck{margin-right:16px}.cl{padding-bottom:10px}.cm{padding-top:10px}.cn{width:32px}.co{height:32px}.cp{fill:rgba(3, 168, 124, 1)}.cq{flex-direction:row}.cr{position:absolute}.cs{width:calc(100% + 25px)}.ct{height:calc(100% + 25px)}.cu{top:50%}.cv{left:50%}.cw{transform:translateX(-50%) translateY(-50%)}.cx{pointer-events:none}.cy{border-radius:50%}.cz{border-top:none}.da{background-color:rgba(53, 88, 118, 1)}.dc{height:54px}.dd{margin-right:40px}.de{height:36px}.df{width:100px}.dg{overflow:auto}.dh{flex:0 1 auto}.di{list-style-type:none}.dj{line-height:40px}.dk{overflow-x:auto}.dl{align-items:flex-start}.dm{margin-top:20px}.dn{padding-top:20px}.do{height:80px}.dp{height:20px}.dq{margin-right:15px}.dr{margin-left:15px}.ds:first-child{margin-left:0}.dt{min-width:1px}.du{background-color:rgba(197, 210, 225, 1)}.dv{font-weight:300}.dw{font-size:15px}.dx{color:rgba(197, 210, 225, 1)}.dy{text-transform:uppercase}.dz{letter-spacing:1px}.ea:hover{color:rgba(251, 255, 255, 1)}.eb:hover{fill:rgba(233, 241, 250, 1)}.ec:disabled{color:rgba(150, 171, 191, 1)}.ed:disabled{fill:rgba(150, 171, 191, 1)}.ee{margin-bottom:0px}.ef{height:119px}.ei{padding-left:24px}.ej{padding-right:24px}.ek{margin-left:auto}.el{margin-right:auto}.em{max-width:728px}.en{box-sizing:border-box}.eo{flex-direction:column}.ep{top:calc(100vh + 100px)}.eq{bottom:calc(100vh + 100px)}.er{width:10px}.es{word-break:break-word}.et{word-wrap:break-word}.eu:after{display:block}.ev:after{content:""}.ew:after{clear:both}.ex{max-width:680px}.ey{line-height:1.23}.ez{letter-spacing:0}.fa{color:rgba(0, 0, 0, 0.84)}.fb{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.fm{margin-bottom:-0.27em}.fs{margin-top:32px}.ft{justify-content:space-between}.fx{height:48px}.fy{width:48px}.fz{margin-left:12px}.ga{margin-bottom:2px}.gc{max-height:20px}.gd{display:-webkit-box}.ge{-webkit-line-clamp:1}.gf{-webkit-box-orient:vertical}.gg:hover{text-decoration:underline}.gh{margin-left:8px}.gi{padding:0px 8px}.gj{background:0}.gk{color:rgba(90, 118, 144, 1)}.gl{fill:rgba(102, 138, 170, 1)}.gm{border-color:rgba(102, 138, 170, 1)}.gn:hover{color:rgba(84, 108, 131, 1)}.go:hover{fill:rgba(90, 118, 144, 1)}.gp:hover{border-color:rgba(90, 118, 144, 1)}.gq{border-radius:4px}.gr{line-height:18px}.gs{border-width:1px}.gt{border-style:solid}.gu{text-decoration:none}.gv{align-items:flex-end}.hd{padding-right:8px}.he{margin-right:-6px}.hf{line-height:1.58}.hg{letter-spacing:-0.004em}.hh{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.hs{margin-bottom:-0.46em}.ht{max-width:721px}.hz{clear:both}.ia{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ib{cursor:zoom-in}.ic{z-index:auto}.id{transition:opacity 100ms 400ms}.ie{height:100%}.if{will-change:transform}.ig{transform:translateZ(0)}.ih{margin:auto}.ii{background-color:rgba(0, 0, 0, 0.05)}.ij{padding-bottom:80.58252427184465%}.ik{filter:blur(20px)}.il{transform:scale(1.1)}.im{visibility:visible}.in{background:rgba(255, 255, 255, 1)}.io{box-shadow:inset 3px 0 0 0 rgba(0, 0, 0, 0.84)}.ip{padding-left:23px}.iq{margin-left:-20px}.ir{font-style:italic}.is{line-height:1.18}.it{letter-spacing:-0.022em}.iu{font-weight:600}.jf{margin-bottom:-0.31em}.jl{font-weight:700}.jm{padding:20px}.jn{background:rgba(0, 0, 0, 0.05)}.jo{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jp{margin-top:-0.09em}.jq{margin-bottom:-0.09em}.jr{white-space:pre-wrap}.jx{background-repeat:repeat-x}.jy{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.jz{background-size:1px 1px}.ka{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.kb{padding:2px 4px}.kc{font-size:75%}.kd> strong{font-family:inherit}.ke{will-change:opacity}.kf{width:188px}.kg{transform:translateX(406px)}.kh{top:calc(65px + 54px + 14px)}.kk{top:calc(65px + 54px + 40px)}.km{width:131px}.kn{padding-bottom:28px}.ko{border-bottom:1px solid rgba(0, 0, 0, 0.1)}.kp{font-size:18px}.kq{padding-bottom:20px}.kr{padding-top:2px}.ks{max-height:120px}.kt{-webkit-line-clamp:6}.ku{left:6px}.kv{padding:4px 12px}.kw{color:rgba(255, 255, 255, 1)}.kx{fill:rgba(255, 255, 255, 1)}.ky{background:rgba(102, 138, 170, 1)}.kz:hover{background:rgba(90, 118, 144, 1)}.la:disabled{cursor:inherit}.lb:disabled{opacity:0.3}.lc:disabled:hover{background:rgba(102, 138, 170, 1)}.ld:disabled:hover{border-color:rgba(102, 138, 170, 1)}.le{padding-top:28px}.lf{margin-bottom:19px}.lg{margin-left:-5px}.lh{margin-right:5px}.li{outline:0}.lj{border:0}.lk{user-select:none}.ll{cursor:pointer}.lm> svg{pointer-events:none}.ln:active{border-style:none}.lo{-webkit-user-select:none}.lp:focus{fill:rgba(90, 118, 144, 1)}.lq{margin-top:5px}.lr button{text-align:left}.ls{margin-top:40px}.lt{flex-wrap:wrap}.lu{margin-top:25px}.lv{margin-right:8px}.lw{margin-bottom:8px}.lx{border-radius:3px}.ly{padding:5px 10px}.lz{line-height:22px}.ma{margin-top:15px}.mb{border:1px solid rgba(0, 0, 0, 0.1)}.mc{height:60px}.md{width:60px}.mq:active{border-style:solid}.mr{z-index:2}.mt{padding-top:32px}.mu{border-top:1px solid rgba(0, 0, 0, 0.1)}.mv{margin-bottom:25px}.mw{margin-bottom:32px}.mx{min-height:80px}.nc{width:80px}.nd{padding-left:102px}.nf{letter-spacing:0.05em}.ng{margin-bottom:6px}.nh{font-size:28px}.ni{line-height:36px}.nj{max-width:555px}.nk{max-width:450px}.nl{line-height:24px}.nn{max-width:550px}.no{padding-top:25px}.np{color:rgba(0, 0, 0, 0.76)}.nq{opacity:1}.nr{border:1px solid rgba(102, 138, 170, 1)}.ns{text-align:center}.nt{margin-top:64px}.nu{background-color:rgba(0, 0, 0, 0.02)}.nv{padding:60px 0}.nw{background-color:rgba(0, 0, 0, 0.9)}.on{padding-bottom:48px}.oo{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.op{margin:0 -12px}.oq{margin:0 12px}.or{flex:1 1 0}.os{padding-bottom:12px}.ot:hover{color:rgba(255, 255, 255, 0.99)}.ou:hover{fill:rgba(255, 255, 255, 0.99)}.ov:disabled{color:rgba(255, 255, 255, 0.7)}.ow:disabled{fill:rgba(255, 255, 255, 0.7)}.ox{color:rgba(255, 255, 255, 0.98)}.oy{fill:rgba(255, 255, 255, 0.98)}.oz{text-align:inherit}.pa{font-size:21.6px}.pb{letter-spacing:-0.32px}.pc{color:rgba(255, 255, 255, 0.7)}.pd{fill:rgba(255, 255, 255, 0.7)}.pe{text-decoration:underline}.pf{padding-bottom:8px}.pg{padding-top:8px}.ph{width:200px}.pj{margin:15px 0}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.fk{font-size:40px}.fl{margin-top:0.78em}.fr{line-height:48px}.hc{margin-left:30px}.hq{font-size:21px}.hr{margin-top:2em}.hy{margin-top:56px}.jd{font-size:26px}.je{margin-top:1.72em}.jk{margin-top:0.86em}.jw{margin-top:1.91em}.ok{padding-left:64px}.ol{padding-right:64px}.om{max-width:1320px}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.hb{margin-left:30px}.oh{padding-left:64px}.oi{padding-right:64px}.oj{max-width:1080px}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.cj{display:flex}.ha{margin-left:30px}.oe{padding-left:48px}.of{padding-right:48px}.og{max-width:904px}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.cg{margin-left:10px}.ch{margin-right:10px}.db{display:block}.eg{margin-bottom:0px}.eh{height:110px}.fv{margin-top:32px}.fw{flex-direction:column-reverse}.gy{margin-bottom:30px}.gz{margin-left:0px}.my{margin-bottom:24px}.mz{align-items:center}.na{width:102px}.nb{position:relative}.ne{padding-left:0}.nm{margin-top:24px}.nx{padding:32px 0}.ob{padding-left:24px}.oc{padding-right:24px}.od{max-width:728px}.pi{width:140px}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.fc{font-size:30px}.fd{margin-top:0.72em}.fn{line-height:40px}.fu{margin-top:32px}.gb{margin-bottom:0px}.gw{margin-bottom:30px}.gx{margin-left:0px}.hi{font-size:18px}.hj{margin-top:1.56em}.hu{margin-top:40px}.iv{font-size:24px}.iw{margin-top:1.23em}.jg{margin-top:0.67em}.js{margin-top:1.41em}.ny{padding-left:24px}.nz{padding-right:24px}.oa{max-width:552px}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.fi{font-size:40px}.fj{margin-top:0.78em}.fq{line-height:48px}.ho{font-size:21px}.hp{margin-top:2em}.hx{margin-top:56px}.jb{font-size:26px}.jc{margin-top:1.72em}.jj{margin-top:0.86em}.jv{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.fg{font-size:40px}.fh{margin-top:0.78em}.fp{line-height:48px}.hm{font-size:21px}.hn{margin-top:2em}.hw{margin-top:56px}.iz{font-size:26px}.ja{margin-top:1.72em}.ji{margin-top:0.86em}.ju{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.fe{font-size:30px}.ff{margin-top:0.72em}.fo{line-height:40px}.hk{font-size:18px}.hl{margin-top:1.56em}.hv{margin-top:40px}.ix{font-size:24px}.iy{margin-top:1.23em}.jh{margin-top:0.67em}.jt{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="print">.ab{display:none}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.y{transition:transform 300ms ease}.z{will-change:transform}.ki{transition:opacity 200ms}.me{transition:border-color 150ms ease}.mf::before{background:
      radial-gradient(circle, rgba(90, 118, 144, 1) 60%, transparent 70%)
    }.mg::before{border-radius:50%}.mh::before{content:""}.mi::before{display:block}.mj::before{z-index:0}.mk::before{left:0}.ml::before{height:100%}.mm::before{position:absolute}.mn::before{top:0}.mo::before{width:100%}.mp:hover::before{animation:k2 2000ms infinite cubic-bezier(.1,.12,.25,1)}.ms{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 1230px)">.kj{display:none}</style><style type="text/css" data-fela-rehydration="425" data-fela-type="RULE" media="all and (max-width: 1198px)">.kl{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y z ab"><div class="branch-journeys-top"><div class="r c"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="n o ao w"><a href="https://medium.com/?source=post_page-----40a16e134691----------------------" aria-label="Homepage" rel="noopener"><svg width="35" height="35" viewBox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a></div><div class="r ap w"><span class="aq b ar as at au r av aw"><div class="n o ax"><div class="n f"><div class="bf" aria-hidden="true"><div class="n"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><svg width="25" height="25" viewBox="0 0 25 25" class="ce cf r cg ch"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></button><input class="bg bh bi bj as bk bl bm bn" placeholder="Search Towards Data Science" value=""/></div></div></div><div class="ci cj"><a href="/search?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25" class="ce ck r cg ch"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></a></div><a href="https://medium.com/me/list/queue?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25" class="ck r g"><path d="M16 6a2 2 0 0 1 2 2v13.66h-.01a.5.5 0 0 1-.12.29.5.5 0 0 1-.7.03l-5.67-4.13-5.66 4.13a.5.5 0 0 1-.7-.03.48.48 0 0 1-.13-.29H5V8c0-1.1.9-2 2-2h9zM6 8v12.64l5.16-3.67a.49.49 0 0 1 .68 0L17 20.64V8a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path><path d="M21 5v13.66h-.01a.5.5 0 0 1-.12.29.5.5 0 0 1-.7.03l-.17-.12V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1H8c0-1.1.9-2 2-2h9a2 2 0 0 1 2 2z"></path></svg></a><div class="ck n ch"><div class="bf" aria-hidden="true"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd r"><svg width="25" height="25" viewBox="-293 409 25 25" class="pj r"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></button></div></div><div class="n" aria-hidden="true"><div class="cl cm n o"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><div class="bl cn co"><div class="cp n cq o p cr cs ct cu cv cw cx"><svg width="39" height="39" viewBox="0 0 39 39"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 1C11.83 1 5.17 5.75 1.9 12.71L1 12.3C4.4 5.02 11.4 0 19.5 0S34.6 5.02 38 12.29l-.9.42C33.82 5.75 27.16 1 19.5 1zM1.9 26.29C5.18 33.25 11.84 38 19.5 38c7.67 0 14.33-4.75 17.6-11.71l.9.42C34.6 33.98 27.6 39 19.5 39S4.4 33.98 1 26.71l.9-.42z"></path></svg></div><img alt="Kevin Lo" class="r cy co cn" src="https://miro.medium.com/fit/c/64/64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32"/></div></button></div></div></div></span></div></div></div></div></div><div class="cz r da db"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="dc bd n o"><div class="dd r ap"><a href="https://towardsdatascience.com/?source=post_page-----40a16e134691----------------------" rel="noopener"><div class="de df r"><img alt="Towards Data Science" class="" src="https://miro.medium.com/max/200/1*mG6i4Bh_LgixUYXJgQpYsg@2x.png" width="100" height="36"/></div></a></div><div class="dg r dh"><ul class="di bw dj be dk n dl g dm dn do"><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/data-science/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Data Science</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/machine-learning/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Machine Learning</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/programming/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Programming</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/data-visualization/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Visualization</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/artificial-intelligence/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">AI</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/our-picks/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Picks</a></span></li><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/more/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">More</a></span></li><span class="dp dt du"></span><li class="n o dp dq dr ds"><span class="aq dv dw as dx dy dz"><a href="https://towardsdatascience.com/contribute/home?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ea eb ca cb ec ed" rel="noopener">Contribute</a></span></li></ul></div></div></div></div></div></div></nav><div class="ee ef r eg eh"></div><article><section class="ei ej ek el ak em en n eo"></section><span class="r"></span><div><div class="cr u ep eq er cx"></div><section class="es et eu ev ew"><div class="n p"><div class="ac ae af ag ah ex aj ak"><div><div id="8bd5" class="ey ez fa ar fb b fc fd fe ff fg fh fi fj fk fl fm"><h1 class="fb b fc fn fe fo fg fp fi fq fk fr fa">High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.</h1></div><div class="fs"><div class="n ft fu fv fw"><div class="o n"><div><a href="/@ratibor78?source=post_page-----40a16e134691----------------------" rel="noopener"><img alt="Alexey Nizhegolenko" class="r cy fx fy" src="https://miro.medium.com/fit/c/96/96/1*aMCBXLrw-RxKEQCGpz5ihw.jpeg" width="48" height="48"/></a></div><div class="fz ak r"><div class="n"><div style="flex:1"><span class="aq b ar as at au r fa q"><div class="ga n o gb"><span class="aq dv bj as bd gc bc gd ge gf fa"><a href="/@ratibor78?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx gg ca cb cc cd" rel="noopener">Alexey Nizhegolenko</a></span><div class="gh r ap h"><button class="gi gj gk gl gm gn go gp bx gq aq b ar gr dw au gs gt en bf gu ca">Follow</button></div></div></span></div></div><span class="aq b ar as at au r av aw"><span class="aq dv bj as bd gc bc gd ge gf av"><div><a class="bo bp bq br bs bt bu bv bw bx gg ca cb cc cd" rel="noopener" href="/high-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691?source=post_page-----40a16e134691----------------------">Dec 3, 2018</a> <!-- -->·<!-- --> <!-- -->10<!-- --> min read</div></span></span></div></div><div class="n gv gw gx gy gz ha hb hc ab"><div class="n o"><div class="hd r ap"><a href="//medium.com/p/40a16e134691/share/twitter?source=post_actions_header---------------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="hd r ap"><a href="//medium.com/p/40a16e134691/share/facebook?source=post_actions_header---------------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="he r ao"><div><div><div class="bf" role="tooltip" aria-hidden="true"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><svg width="25" height="25" viewBox="0 1 25 25" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.47 9.95h17v-3h-17v3zm16 1h1a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-17a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h1v9a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-9zm-1 0h-13v9h13v-9z" fill="#757575"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M9.47 12.45c0-.28.21-.5.48-.5h6.04c.27 0 .48.22.48.5 0 .27-.21.5-.48.5H9.95a.49.49 0 0 1-.48-.5z" fill="#757575"></path></svg></button></div></div></div></div></div></div></div></div></div><p id="f87e" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes, with load balancing and failover capability based on HAProxy &amp; Heartbeat.</p><p id="4a3d" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">On most of modern projects, the database availability is a matter of life and death. Good solution will be creation a distributed database cluster, from more then one MySQL server, that can take care of load balancing, failover capabilities and data replication. Also, you can split an incoming requests and take care about high load.</p><p id="c4b5" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">In this example I will show creating a MySQL cluster from two master nodes, main idea is to create a pair of servers with same configurations and one virtual IP for taking requests. This cluster will continue working even after totally losing one of the nodes.</p><p id="2e22" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">We’ll use a two servers (virtual or bare metal) with pair of MySQL masters and a pair of HAProxy installed on them, the main virtual IP will be configured with Heartbeat. Please mind that in this example only one HAProxy be using in one time period, the second HAProxy will be standing in hot reserve. MySQL servers will be recycle with round robin type of load balancing.</p><figure class="hu hv hw hx hy hz ek el paragraph-image"><div class="ia ib bl ic ak"><div class="ek el ht"><div class="ih r bl ii"><div class="ij r"><div class="bk id cr t u ie ak bd if ig"><img class="cr t u ie ak ik il im" src="https://miro.medium.com/max/60/1*-UDKtIOlY9KCgnT0iTIuCg.png?q=20" width="721" height="581" role="presentation"/></div><img class="bk id cr t u ie ak in" width="721" height="581" role="presentation"/><noscript><img class="cr t u ie ak" src="https://miro.medium.com/max/1442/1*-UDKtIOlY9KCgnT0iTIuCg.png" width="721" height="581" role="presentation"/></noscript></div></div></div></div></figure><blockquote class="io ip iq"><p id="8f05" class="hf hg fa ir hh b hi hj hk hl hm hn ho hp hq hr hs es">The schema with two servers was chosen for making an example simpler. Of course if you have an additional servers, you can create a more complicated configurations, putting HAProxy with Heartbeat in external LB cluster and so on. But anyway, this example will be a quite enough for building a strong looking DB cluster inside your project.</p></blockquote><h2 id="0394" class="is it fa ar aq iu iv iw ix iy iz ja jb jc jd je jf"><strong class="bu">0. Preparing.</strong></h2><p id="1a5b" class="hf hg fa ar hh b hi jg hk jh hm ji ho jj hq jk hs es">First we’ll need to choose few subnets for the MySQL replications and for the HAProxy with Heartbeat, better separate them and if your server have a few network interface put these subnets on different interfaces as well.</p><p id="546a" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es"><strong class="hh jl">192.168.0.0/24</strong> - network for DB traffic</p><p id="c5f3" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es"><strong class="hh jl">192.168.0.1 </strong>IP for MySQL1, <strong class="hh jl">192.168.0.2</strong> IP for MySQL2.</p><p id="c2c8" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es"><strong class="hh jl">10.10.10.0/24</strong> - network for the Heartbeat &amp; HAProxy.</p><p id="679a" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es"><strong class="hh jl">10.10.10.1 </strong>Virtual IP for taking requests, <strong class="hh jl">10.10.10.2</strong> main IP for <strong class="hh jl">sever1</strong>, <strong class="hh jl">10.10.10.3</strong> main IP for <strong class="hh jl">server2</strong>.</p><blockquote class="io ip iq"><p id="5268" class="hf hg fa ir hh b hi hj hk hl hm hn ho hp hq hr hs es">The /29 subnets will be quite enough in fact :)</p></blockquote><h2 id="5ed9" class="is it fa ar aq iu iv iw ix iy iz ja jb jc jd je jf"><strong class="bu">1. Configuring MySQL servers with master - master replication.</strong></h2><p id="6908" class="hf hg fa ar hh b hi jg hk jh hm ji ho jj hq jk hs es">First we need to install MySQL on both of ours servers:</p><pre class="hu hv hw hx hy jm jn dk"><span id="6e0f" class="is it fa ar jo b bj jp jq r jr"># apt-get update &amp;&amp; apt-get upgrade -y</span><span id="d938" class="is it fa ar jo b bj js jt ju jv jw jq r jr"># apt-get install mysql-server mysql-client</span></pre><p id="3646" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Then edit the <strong class="hh jl">/etc/mysql/my.cnf</strong> on first and second node, to enable replication between MySQL servers and make them use IPS from 192.168.0.0/24 subnet:</p><p id="f86a" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Server1 configuration.</p><pre class="hu hv hw hx hy jm jn dk"><span id="174d" class="is it fa ar jo b bj jp jq r jr">[mysqld]</span><span id="501e" class="is it fa ar jo b bj js jt ju jv jw jq r jr">bind-address    = 192.168.0.1</span><span id="cc64" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server_id           = 1<br/>log_bin             = /var/log/mysql/mysql-bin.log<br/>log_bin_index       = /var/log/mysql/mysql-bin.log.index<br/>relay_log           = /var/log/mysql/mysql-relay-bin<br/>relay_log_index     = /var/log/mysql/mysql-relay-bin.index<br/>expire_logs_days    = 10<br/>max_binlog_size     = 100M<br/>log_slave_updates   = 1<br/>auto-increment-increment = 2<br/>auto-increment-offset = 1</span></pre><p id="f33a" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Server2 configuration.</p><pre class="hu hv hw hx hy jm jn dk"><span id="694b" class="is it fa ar jo b bj jp jq r jr">[mysqld]</span><span id="5125" class="is it fa ar jo b bj js jt ju jv jw jq r jr">bind-address    = 192.168.0.2</span><span id="7d71" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server_id           = 2<br/>log_bin             = /var/log/mysql/mysql-bin.log<br/>log_bin_index       = /var/log/mysql/mysql-bin.log.index<br/>relay_log           = /var/log/mysql/mysql-relay-bin<br/>relay_log_index     = /var/log/mysql/mysql-relay-bin.index<br/>expire_logs_days    = 10<br/>max_binlog_size     = 100M<br/>log_slave_updates   = 1<br/>auto-increment-increment = 2<br/>auto-increment-offset = 2</span></pre><p id="2ec5" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Then restart them both and make sure MySQL leaf on specified IP:</p><pre class="hu hv hw hx hy jm jn dk"><span id="acf6" class="is it fa ar jo b bj jp jq r jr">server1# systemctl restart mysql</span><span id="f80b" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server1# netstat -ntlp</span><span id="1cc6" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Active Internet connections (only servers)<br/>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br/>tcp        0      0 192.168.0.1:3306        0.0.0.0:*               LISTEN      9057/mysqld</span><span id="e6ac" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# systemctl restart mysql</span><span id="b106" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# netstat -ntlp</span><span id="a32a" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Active Internet connections (only servers)<br/>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    <br/>tcp        0      0 192.168.0.2:3306        0.0.0.0:*               LISTEN      8740/mysqld</span></pre><p id="29c7" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Now will create a user for replication between databases, you can use <strong class="hh jl">pwgen</strong> utility to generate strong enough password. Connect to each MySQL servers and create this user with IP from opposite server:</p><pre class="hu hv hw hx hy jm jn dk"><span id="7880" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p</span><span id="64ef" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->GRANT REPLICATION SLAVE ON *.* TO &#x27;replicauser&#x27;@&#x27;192.168.0.2&#x27; IDENTIFIED BY &#x27;somestrongpassword&#x27;;</span><span id="5de3" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# <!-- -->mysql -u root -p</span><span id="f964" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; GRANT REPLICATION SLAVE ON *.* TO &#x27;replicauser&#x27;@&#x27;192.168.0.1&#x27; IDENTIFIED BY &#x27;<!-- -->somestrongpassword<!-- -->&#x27;;</span></pre><p id="c4d9" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Check that <strong class="hh jl">replicauser</strong> have access for each MySQL server.</p><pre class="hu hv hw hx hy jm jn dk"><span id="b5d6" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u replicauser -p -h 192.168.0.2<br/>Enter password: <!-- -->somestrongpassword<br/>Welcome to the MariaDB monitor.  Commands end with ; or \g.<strong class="jo jl"><br/></strong>bla bla....</span><span id="8008" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# mysql -u replicauser -p -h 192.168.0.1<br/>Enter password: <!-- -->somestrongpassword<br/>Welcome to the MariaDB monitor.  Commands end with ; or \g.<strong class="jo jl"><br/></strong>bla bla....</span></pre><p id="d0d1" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Fine, now we can continue with configuring replication between MySQL servers. From that time better to have opened two consoles from both of MySQL servers, as we need to input commands, based on output from another server.</p><p id="3580" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Get the MySQL master status on server1:</p><pre class="hu hv hw hx hy jm jn dk"><span id="35cc" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p</span><span id="3ce9" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->SHOW MASTER STATUS;</span><span id="9418" class="is it fa ar jo b bj js jt ju jv jw jq r jr">+------------------+----------+--------------+------------------+<br/>| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |<br/>+------------------+----------+--------------+------------------+<br/>| mysql-bin.000002 |      531 |              |                  |<br/>+------------------+----------+--------------+------------------+<br/>1 row in set (0.00 sec)</span></pre><p id="40ac" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">We’ll need the <strong class="hh jl">File</strong> and <strong class="hh jl">Position</strong> information, from this output. Open the MySQL console on server2 and configure the slave relation with first server.</p><pre class="hu hv hw hx hy jm jn dk"><span id="a98a" class="is it fa ar jo b bj jp jq r jr">server2# mysql -u root -p</span><span id="6922" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->STOP SLAVE;</span><span id="78ed" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->CHANGE MASTER TO master_host=&#x27;192.168.0.1&#x27;, master_port=3306, master_user=&#x27;replicauser&#x27;, master_password=&#x27;somestrongpassword&#x27;, master_log_file=&#x27;<!-- -->mysql-bin.000002<!-- -->&#x27;, master_log_pos=<!-- -->531<!-- -->;</span><span id="bace" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->START SLAVE;</span></pre><p id="57ee" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Now query the master status from server2 and configure slave relation for MySQL on first server.</p><pre class="hu hv hw hx hy jm jn dk"><span id="bc8d" class="is it fa ar jo b bj jp jq r jr">server2# mysql -u root -p</span><span id="4d5c" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->SHOW MASTER STATUS;</span><span id="5028" class="is it fa ar jo b bj js jt ju jv jw jq r jr">+------------------+----------+--------------+------------------+<br/>| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |<br/>+------------------+----------+--------------+------------------+<br/>| mysql-bin.000002 |      531 |              |                  |<br/>+------------------+----------+--------------+------------------+<br/>1 row in set (0.00 sec)</span><span id="b96a" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server1# mysql -u root -p</span><span id="ef1e" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->STOP SLAVE;</span><span id="97ea" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->CHANGE MASTER TO master_host=&#x27;192.168.0.2&#x27;, master_port=3306, master_user=&#x27;replicauser&#x27;, master_password=&#x27;somestrongpassword&#x27;, master_log_file=&#x27;<!-- -->mysql-bin.000002<!-- -->&#x27;, master_log_pos=<!-- -->531<!-- -->;</span><span id="24e0" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->START SLAVE;</span></pre><p id="4d4d" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">OK, if all was done right, we must have a working replication between MySQL masters. You can create some test DB and check this.</p><pre class="hu hv hw hx hy jm jn dk"><span id="a3a8" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p</span><span id="8130" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; CREATE DATABASE TESTDB;<br/>MariaDB&gt; <!-- -->CREATE TABLE TESTDB.REPLICA (`id` varchar(40));</span></pre><p id="06d1" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Then check this database was appeared on second server as well:</p><pre class="hu hv hw hx hy jm jn dk"><span id="3f4e" class="is it fa ar jo b bj jp jq r jr">server2# mysql -u root -p</span><span id="9c2d" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; <!-- -->SHOW TABLES IN TESTDB;<br/>+------------------+<br/>| Tables_in_TESTDB |<br/>+------------------+<br/>| REPLICA          |<br/>+------------------+<br/>1 row in set (0.00 sec)</span></pre><p id="4247" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">And as you can see, the <strong class="hh jl">TESTDB</strong> base was successfully replicated to server2. We just completed a first stage of creating our failover cluster.</p><h2 id="45be" class="is it fa ar aq iu iv iw ix iy iz ja jb jc jd je jf">2. <strong class="bu">Configuring HAProxy on both servers.</strong></h2><p id="82eb" class="hf hg fa ar hh b hi jg hk jh hm ji ho jj hq jk hs es">In second stage we’ll install and configure two absolutely identical HAProxy on both of our servers, for balancing a incoming requests between MySQL servers.</p><p id="9f38" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">First we need to add additional user on our MySQL servers (user must be created without any password), this user will be used by HAProxy for checking a health status of MySQL servers.</p><pre class="hu hv hw hx hy jm jn dk"><span id="f16f" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p</span><span id="b91d" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; CREATE USER &#x27;haproxy_check&#x27;@&#x27;%&#x27;;<br/>MariaDB&gt; FLUSH PRIVILEGES;</span></pre><p id="443b" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">You can create this user on any of our MySQL servers, as we have a replication configured between them. Check that user was added, using this command:</p><pre class="hu hv hw hx hy jm jn dk"><span id="8bb8" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p -e &quot;SELECT User, Host FROM mysql.user&quot;<br/>Enter password: <br/>+---------------+-------------+<br/>| User          | Host        |<br/>+---------------+-------------+<br/>| haproxy_check | %           |<br/>| replicauser   | 192.168.0.2 |<br/>| root          | localhost   |<br/>+---------------+-------------+</span><span id="1768" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# mysql -u root -p -e &quot;SELECT User, Host FROM mysql.user&quot;<br/>Enter password: <br/>+---------------+-------------+<br/>| User          | Host        |<br/>+---------------+-------------+<br/>| haproxy_check | %           |<br/>| replicauser   | 192.168.0.1 |<br/>| root          | localhost   |<br/>+---------------+-------------+</span></pre><p id="3dd3" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Also let’s create a user with root privileges, for making some test requests later:</p><pre class="hu hv hw hx hy jm jn dk"><span id="cf22" class="is it fa ar jo b bj jp jq r jr">server1# mysql -u root -p</span><span id="ecff" class="is it fa ar jo b bj js jt ju jv jw jq r jr">MariaDB&gt; CREATE USER &#x27;haproxy_root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;password&#x27;;<br/>MariaDB&gt; GRANT ALL PRIVILEGES ON *.* TO &#x27;haproxy_root&#x27;@&#x27;%&#x27;;</span></pre><p id="d286" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Now it’s time for HAProxy installation:</p><pre class="hu hv hw hx hy jm jn dk"><span id="0556" class="is it fa ar jo b bj jp jq r jr">server1# apt-get install haproxy<br/>server2# apt-get install haproxy</span></pre><p id="4e7b" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Save original config and create new one:</p><pre class="hu hv hw hx hy jm jn dk"><span id="e3dc" class="is it fa ar jo b bj jp jq r jr">server1# mv /etc/haproxy/haproxy.cfg{,.back}<br/>server1# vi /etc/haproxy/haproxy.cfg</span></pre><p id="d358" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Next add this configuration on both servers:</p><pre class="hu hv hw hx hy jm jn dk"><span id="1096" class="is it fa ar jo b bj jp jq r jr">global<br/>    user haproxy<br/>    group haproxy</span><span id="b576" class="is it fa ar jo b bj js jt ju jv jw jq r jr">defaults<br/>    mode http<br/>    log global<br/>    retries 2<br/>    timeout connect 3000ms<br/>    timeout server 5000ms<br/>    timeout client 5000ms</span><span id="c8dc" class="is it fa ar jo b bj js jt ju jv jw jq r jr">listen stats<br/>    bind 10.10.10.1:9999<br/>    stats enable<br/>    stats hide-version<br/>    stats uri /stats<br/>    stats auth statadmin:statadminpass</span><span id="c4ea" class="is it fa ar jo b bj js jt ju jv jw jq r jr">listen mysql-cluster<br/>    bind 10.10.10.1:3306<br/>    mode tcp<br/>    option mysql-check user haproxy_check<br/>    balance roundrobin<br/>    server mysql-1 192.168.0.1:3306 check<br/>    server mysql-2 192.168.0.2:3306 check</span></pre><p id="21e3" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">As you can see, both HAProxy services will use 10.10.10.1, shared IP address. This virtual IP will move on between servers, so we need to make some trick and enable <strong class="hh jl">net.ipv4.ip_nonlocal_bind</strong> sysctl option, to allow system services binding on the non-local IP.</p><p id="09f2" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Add to the file <strong class="hh jl">/etc/sysctl.conf</strong> this option:</p><pre class="hu hv hw hx hy jm jn dk"><span id="86e1" class="is it fa ar jo b bj jp jq r jr"><em class="ir">server1# vi /etc/sysctl.conf</em></span><span id="5c35" class="is it fa ar jo b bj js jt ju jv jw jq r jr">net.ipv4.ip_nonlocal_bind=1</span><span id="14b0" class="is it fa ar jo b bj js jt ju jv jw jq r jr"><em class="ir">server2# vi /etc/sysctl.conf</em></span><span id="cb60" class="is it fa ar jo b bj js jt ju jv jw jq r jr">net.ipv4.ip_nonlocal_bind=1</span></pre><p id="a2a4" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Then run</p><pre class="hu hv hw hx hy jm jn dk"><span id="0832" class="is it fa ar jo b bj jp jq r jr"><em class="ir">sysctl -p</em></span></pre><p id="ce47" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">After this, we can start HAProxy on both servers:</p><pre class="hu hv hw hx hy jm jn dk"><span id="d455" class="is it fa ar jo b bj jp jq r jr">server1# systemctl start haproxy<br/>server2# systemctl start haproxy</span></pre><p id="3eb3" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Check they started on shared IP 10.10.10.1:</p><pre class="hu hv hw hx hy jm jn dk"><span id="79a9" class="is it fa ar jo b bj jp jq r jr">server1# netstat -ntlp </span><span id="49f4" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Active Internet connections (only servers) <br/>Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name <br/>tcp 0 0 192.168.0.1:3306 0.0.0.0:* LISTEN 918/mysqld <br/>tcp 0 0 10.10.10.1:3306 0.0.0.0:* LISTEN 802/haproxy <br/>tcp 0 0 10.10.10.1:9999 0.0.0.0:* LISTEN 802/haproxy <br/>tcp 0 0 10.10.10.2:22 0.0.0.0:* LISTEN 785/sshd</span><span id="9fdf" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# netstat -ntlp</span><span id="0521" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Active Internet connections (only servers) <br/>Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name <br/>tcp 0 0 192.168.0.2:3306 0.0.0.0:* LISTEN 918/mysqld <br/>tcp 0 0 10.10.10.1:3306 0.0.0.0:* LISTEN 802/haproxy <br/>tcp 0 0 10.10.10.1:9999 0.0.0.0:* LISTEN 802/haproxy <br/>tcp 0 0 10.10.10.3:22 0.0.0.0:* LISTEN 785/sshd</span></pre><p id="ddcc" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Everything look’s OK, both servers was started using virtual IP, also we configured a stats page on 9999 port, so you can check the HAProxy status on <a href="http://10.10.10.1:9999/stats" class="bo gu jx jy jz ka" target="_blank" rel="noopener nofollow">http://10.10.10.1:9999/stats</a> using statadmin:statadminpass.</p><h2 id="cccb" class="is it fa ar aq iu iv iw ix iy iz ja jb jc jd je jf">3. <strong class="bu">Configuring Heartbeat with shared IP.</strong></h2><p id="b155" class="hf hg fa ar hh b hi jg hk jh hm ji ho jj hq jk hs es">On last stage we need to configure the Heartbeat service on both of the servers, and create shared IP, that will be used for serving incoming requests. This IP will migrate between servers if something wrong happens to one of them.</p><p id="084b" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Install Heartbeat on both servers:</p><pre class="hu hv hw hx hy jm jn dk"><span id="8d0f" class="is it fa ar jo b bj jp jq r jr">server1# apt-get install heartbeat<br/>server1# systemctl enable heartbeat</span><span id="56ad" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# apt-get install heartbeat<br/>server2# systemctl enable heartbeat</span></pre><p id="d15a" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Now we need to create a few configuration files for it, they will be mostly the same for the server1 and server2.</p><p id="58d0" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Create a <strong class="hh jl">/etc/ha.d/authkeys</strong>, in this file Heartbeat stored data to authenticate each other. File will be the same on both servers:</p><pre class="hu hv hw hx hy jm jn dk"><span id="68b2" class="is it fa ar jo b bj jp jq r jr">server1# vi /etc/ha.d/authkeys</span><span id="175e" class="is it fa ar jo b bj js jt ju jv jw jq r jr">auth 1<br/>1 md5 securepass</span><span id="4f1a" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# vi /etc/ha.d/authkeys</span><span id="c028" class="is it fa ar jo b bj js jt ju jv jw jq r jr">auth 1<br/>1 md5 securepass</span></pre><p id="af78" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Change the <strong class="hh jl">securepass</strong> to your strong secure password. Also, this file need to be owned by root only, so:</p><pre class="hu hv hw hx hy jm jn dk"><span id="4300" class="is it fa ar jo b bj jp jq r jr">server1# chmod 600 /etc/ha.d/authkeys<br/>server2# chmod 600 /etc/ha.d/authkeys</span></pre><p id="c892" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Next will create a main configuration for Heartbeat on both servers, it’ll be a bit different for server1 and server2, create <strong class="hh jl">/etc/ha.d/ha.cf</strong>:</p><p id="2ce9" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">server1</p><pre class="hu hv hw hx hy jm jn dk"><span id="c80b" class="is it fa ar jo b bj jp jq r jr">server1# vi /etc/ha.d/ha.cf</span><span id="78a7" class="is it fa ar jo b bj js jt ju jv jw jq r jr">#       keepalive: how many seconds between heartbeats<br/>#<br/>keepalive 2<br/>#<br/>#       deadtime: seconds-to-declare-host-dead<br/>#<br/>deadtime 10<br/>#<br/>#       What UDP port to use for udp or ppp-udp communication?<br/>#<br/>udpport        694<br/>bcast  ens18<br/>mcast ens18 225.0.0.1 694 1 0<br/>ucast ens18 10.10.10.3<br/>#       What interfaces to heartbeat over?<br/>udp     ens18<br/>#<br/>#       Facility to use for syslog()/logger (alternative to log/debugfile)<br/>#<br/>logfacility     local0<br/>#<br/>#       Tell what machines are in the cluster<br/>#       node    nodename ...    -- must match uname -n<br/>node    server1<br/>node    server2</span></pre><p id="38a0" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">server2</p><pre class="hu hv hw hx hy jm jn dk"><span id="f424" class="is it fa ar jo b bj jp jq r jr">server1# vi /etc/ha.d/ha.cf</span><span id="453f" class="is it fa ar jo b bj js jt ju jv jw jq r jr">#       keepalive: how many seconds between heartbeats<br/>#<br/>keepalive 2<br/>#<br/>#       deadtime: seconds-to-declare-host-dead<br/>#<br/>deadtime 10<br/>#<br/>#       What UDP port to use for udp or ppp-udp communication?<br/>#<br/>udpport        694<br/>bcast  ens18<br/>mcast ens18 225.0.0.1 694 1 0<br/>ucast ens18 10.10.10.2<br/>#       What interfaces to heartbeat over?<br/>udp     ens18<br/>#<br/>#       Facility to use for syslog()/logger (alternative to log/debugfile)<br/>#<br/>logfacility     local0<br/>#<br/>#       Tell what machines are in the cluster<br/>#       node    nodename ...    -- must match uname -n<br/>node    server1<br/>node    server2</span></pre><p id="4448" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">The <strong class="hh jl">node</strong> names for this config you can get by running <code class="ii kb kc kd jo b">uname -n</code> on your servers.</p><p id="95bf" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">And last we need to create the<strong class="hh jl"> /etc/ha.d/haresources </strong>file on server1 and server2. File be the same and in this file we’ll declare our shared IP address and master node by default:</p><pre class="hu hv hw hx hy jm jn dk"><span id="8850" class="is it fa ar jo b bj jp jq r jr">server1# vi /etc/ha.d/haresources</span><span id="d963" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server1 10.10.10.1</span><span id="de0e" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server2# vi /etc/ha.d/haresources</span><span id="24cd" class="is it fa ar jo b bj js jt ju jv jw jq r jr">server1 10.10.10.1</span></pre><p id="3de5" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">After all let’s start our Heartbeat services on both servers, and you must see that on server1 we have the virtual IP up:</p><pre class="hu hv hw hx hy jm jn dk"><span id="9e63" class="is it fa ar jo b bj jp jq r jr">server1# ip a <br/>....<br/>2: ens19: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br/>    link/ether bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff<br/>    inet 192.168.0.1/24 brd 192.168.0.255 scope global ens19<br/>       valid_lft forever preferred_lft forever<br/>    inet6 fe80::bla:bla:bla:bla/64 scope link <br/>       valid_lft forever preferred_lft forever<br/>3: ens18: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br/>    link/ether bla:bla:bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff<br/>    inet 10.10.10.2/24 brd 10.10.10.255 scope global ens18<br/>       valid_lft forever preferred_lft forever<br/>    inet 10.10.10.1/24 brd 10.10.10.255 scope global secondary <br/>....</span></pre><p id="bf1b" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">OK, now we have virtual IP assigned on our server1 and HAProxy listening on it, so we can check how it works, making test requests. From some external server run this commands:</p><pre class="hu hv hw hx hy jm jn dk"><span id="4a48" class="is it fa ar jo b bj jp jq r jr"># mysql -h 10.10.10.1 -u haproxy_root -p -e &quot;show variables like &#x27;server_id&#x27;&quot;</span><span id="7cca" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Enter password: <br/>+---------------+-------+<br/>| Variable_name | Value |<br/>+---------------+-------+<br/>| server_id     | 1     |<br/>+---------------+-------+</span><span id="ba06" class="is it fa ar jo b bj js jt ju jv jw jq r jr"># mysql -h 10.10.10.1 -u haproxy_root -p -e &quot;show variables like &#x27;server_id&#x27;&quot;</span><span id="5c38" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Enter password: <br/>+---------------+-------+<br/>| Variable_name | Value |<br/>+---------------+-------+<br/>| server_id     | 2     |<br/>+---------------+-------+</span></pre><p id="9ae5" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">All working fine, you can see the “round robin” balancing between our MySQL servers. Now we need to check the failover when the server1 will go offline for example. Go and restart or shutdown the server1, and check that virtual IP was moved to server2 and requests to the MySQL servers still OK, but now there is only MySQL on server2 will respond:</p><pre class="hu hv hw hx hy jm jn dk"><span id="0e1a" class="is it fa ar jo b bj jp jq r jr">server2# ip a <br/>....<br/>2: ens19: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br/>    link/ether bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff<br/>    inet 192.168.0.2/24 brd 192.168.0.255 scope global ens19<br/>       valid_lft forever preferred_lft forever<br/>    inet6 fe80::bla:bla:bla:bla/64 scope link <br/>       valid_lft forever preferred_lft forever<br/>3: ens18: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br/>    link/ether bla:bla:bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff<br/>    inet 10.10.10.3/24 brd 10.10.10.255 scope global ens18<br/>       valid_lft forever preferred_lft forever<br/>    inet 10.10.10.1/24 brd 10.10.10.255 scope global secondary <br/>....</span></pre><p id="78cd" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Check MySQL requests again:</p><pre class="hu hv hw hx hy jm jn dk"><span id="08c1" class="is it fa ar jo b bj jp jq r jr"># mysql -h 10.10.10.1 -u haproxy_root -p -e &quot;show variables like &#x27;server_id&#x27;&quot;</span><span id="37fe" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Enter password: <br/>+---------------+-------+<br/>| Variable_name | Value |<br/>+---------------+-------+<br/>| server_id     | 2     |<br/>+---------------+-------+</span><span id="ddb1" class="is it fa ar jo b bj js jt ju jv jw jq r jr"># mysql -h 10.10.10.1 -u haproxy_root -p -e &quot;show variables like &#x27;server_id&#x27;&quot;</span><span id="0829" class="is it fa ar jo b bj js jt ju jv jw jq r jr">Enter password: <br/>+---------------+-------+<br/>| Variable_name | Value |<br/>+---------------+-------+<br/>| server_id     | 2     |<br/>+---------------+-------+</span></pre><p id="2412" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">After the server1 will return online, the virtual IP will be moved back to it.</p><p id="a3b4" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">And we did, we just configured and tested our MySQL cluster, and it now readies to serve requests.</p><p id="d7e0" class="hf hg fa ar hh b hi hj hk hl hm hn ho hp hq hr hs es">Good luck.</p></div></div></section></div></article><div class="bk cx ke s ak kk ki kl" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="km n eo"><div class="cx"><div class="kn ko r"><a href="https://towardsdatascience.com/?source=post_sidebar--------------------------post_sidebar-" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener"><h2 class="aq iu kp as fa">Towards Data Science</h2></a><div class="kq kr r"><h4 class="aq dv bj as bd ks bc gd kt gf av">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="bf" aria-hidden="true"><button class="kv kw kx ky gm kz gp bx la lb lc ld gq aq b ar as at au gs gt en bf gu ca">Following<span class="bl ku"><svg width="21" height="21" viewBox="0 0 21 21"><path d="M4 7.33L10.03 14l.5.55.5-.55 5.96-6.6-.98-.9-5.98 6.6h1L4.98 6.45z" fill-rule="evenodd"></path></svg></span></button></div></div><div class="le lf lg n"><div class="n o"><div class="lh r bl"><div class=""><button class="bv li lj lk ll lm ln lo gl lp go"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="lq r"><div class="lr"><h4 class="aq dv bj as av"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd">364 </button></h4></div></div></div></div><div><div><div class="bf" role="tooltip" aria-hidden="true"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><svg width="25" height="25" viewBox="0 1 25 25" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.47 9.95h17v-3h-17v3zm16 1h1a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-17a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h1v9a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-9zm-1 0h-13v9h13v-9z" fill="#757575"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M9.47 12.45c0-.28.21-.5.48-.5h6.04c.27 0 .48.22.48.5 0 .27-.21.5-.48.5H9.95a.49.49 0 0 1-.48-.5z" fill="#757575"></path></svg></button></div></div></div></div></div></div></div></div><div class="bk cx ke s kf cv kg kh ki kj"></div><div><div class="ls hz n eo p"><div class="n p"><div class="ac ae af ag ah ex aj ak"><div class="n lt"></div><div class="n o lt"></div><div class="lu r"><ul class="bv bw"><li class="bf di lv lw"><a href="/tag/mysql" class="lx ly gu av r jn lz a b dw">MySQL</a></li><li class="bf di lv lw"><a href="/tag/heartbeat" class="lx ly gu av r jn lz a b dw">Heartbeat</a></li><li class="bf di lv lw"><a href="/tag/haproxy" class="lx ly gu av r jn lz a b dw">Haproxy</a></li><li class="bf di lv lw"><a href="/tag/cluster" class="lx ly gu av r jn lz a b dw">Cluster</a></li><li class="bf di lv lw"><a href="/tag/load-balancing" class="lx ly gu av r jn lz a b dw">Load Balancing</a></li></ul></div><div class="ma n ft ab"><div class="n o"><div class="ck r bl"><div class=""><div class="c mb cy n o mc bl md me mf mg mh mi mj mk ml mm mn mo mp gp"><button class="bv li lj lk ll lm mq lo o in cy n p mr u ie cr t ak gl lp go ms"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></button></div></div></div><div class="lq r"><div class="lr"><h4 class="aq dv bj as fa"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd">364 claps</button></h4></div></div></div><div class="n o"><div class="hd r ap"><a href="//medium.com/p/40a16e134691/share/twitter?source=post_actions_footer---------------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="hd r ap"><a href="//medium.com/p/40a16e134691/share/facebook?source=post_actions_footer---------------------------" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" target="_blank" rel="noopener nofollow"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="hd r ap"><div><div><div class="bf" role="tooltip" aria-hidden="true"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><svg width="25" height="25" viewBox="0 1 25 25" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.47 9.95h17v-3h-17v3zm16 1h1a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-17a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h1v9a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-9zm-1 0h-13v9h13v-9z" fill="#757575"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M9.47 12.45c0-.28.21-.5.48-.5h6.04c.27 0 .48.22.48.5 0 .27-.21.5-.48.5H9.95a.49.49 0 0 1-.48-.5z" fill="#757575"></path></svg></button></div></div></div></div><div class="bf" aria-hidden="true"><div class="bf" aria-hidden="true"><div class="r ap"><button class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div><div class="mt mu mv lu r ab"><div class="mw mx r bl"><span class="r my an mz"><div class="r cr na nb"><a href="/@ratibor78?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Alexey Nizhegolenko" class="r cy do nc" src="https://miro.medium.com/fit/c/160/160/1*aMCBXLrw-RxKEQCGpz5ihw.jpeg" width="80" height="80"/></a></div><span class="r"><div class="nd r ne"><p class="aq dv dw as av dy nf">Written by</p></div><div class="nd ng n ne"><div class="ak n o ft"><h2 class="aq iu nh ni fa"><a href="/@ratibor78?source=follow_footer--------------------------follow_footer-" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener">Alexey Nizhegolenko</a></h2><div class="r g"><button class="kv gj gk gl gm gn go gp bx gq aq b ar as at au gs gt en bf gu ca">Follow</button></div></div></div></span></span><div class="nd nj r ne db"><div class="nk r"><h4 class="aq dv kp nl av">Sysadmin &amp; DevOps Engineer in Internetvikings, Stockholm.</h4></div><div class="ci nm db"><button class="kv gj gk gl gm gn go gp bx gq aq b ar as at au gs gt en bf gu ca">Follow</button></div></div></div><div class="mt r"></div><div class="mw mx r bl"><span class="r my an mz"><div class="r cr na nb"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Towards Data Science" class="gq nc do" src="https://miro.medium.com/fit/c/160/160/1*hVxgUA6kP-PgL5TJjuyePg.png" width="80" height="80"/></a></div><span class="r"><div class="nd ng n ne"><div class="ak n o ft"><h2 class="aq iu nh ni fa"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener">Towards Data Science</a></h2><div class="r g"><div class="bf" aria-hidden="true"><button class="kv kw kx ky gm kz gp bx la lb lc ld gq aq b ar as at au gs gt en bf gu ca">Following<span class="bl ku"><svg width="21" height="21" viewBox="0 0 21 21"><path d="M4 7.33L10.03 14l.5.55.5-.55 5.96-6.6-.98-.9-5.98 6.6h1L4.98 6.45z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></span></span><div class="nd nn r ne db"><div class="nk r"><h4 class="aq dv kp nl av">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="ci nm db"><div class="bf" aria-hidden="true"><button class="kv kw kx ky gm kz gp bx la lb lc ld gq aq b ar as at au gs gt en bf gu ca">Following<span class="bl ku"><svg width="21" height="21" viewBox="0 0 21 21"><path d="M4 7.33L10.03 14l.5.55.5-.55 5.96-6.6-.98-.9-5.98 6.6h1L4.98 6.45z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="no mu r ab"><a href="https://medium.com/p/40a16e134691/responses/show?source=follow_footer--------------------------follow_footer-" class="bo bp bq br bs bt bu bv bw bx by bz ca cb cc cd" rel="noopener"><span class="np nq ll"><div class="jm nr gq r ns db"><span class="gk">See responses (11)</span></div></span></a></div></div></div><div class="nt r nu ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"></div></div></div></div></div><div class="nv r nw nx"><section class="ek el ak en r ny nz oa ob oc od oe of og oh oi oj ok ol om"><div class="on oo mw n ft g"><div class="op n ft"><div class="oq r or"><div class="os r"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ot ou ca cb ov ow" rel="noopener"><h4 class="ox oy oz aq iu ar nl pa pb r">Discover <!-- -->Medium</h4></a></div><span class="aq b ar as at au r pc pd">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ca cb ov ow pe" rel="noopener">Watch</a></span></div><div class="oq r or"><div class="pf r"><a href="https://medium.com/topics?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ot ou ca cb ov ow" rel="noopener"><h4 class="ox oy oz aq iu ar nl pa pb r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="aq b ar as at au r pc pd">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ca cb ov ow pe" rel="noopener">Explore</a></span></div><div class="oq r or"><div class="os r"><a href="https://medium.com/topic/members?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ot ou ca cb ov ow" rel="noopener"><h4 class="ox oy oz aq iu ar nl pa pb r">Explore your membership</h4></a></div><span class="aq b ar as at au r pc pd">Thank you for being a member of <!-- -->Medium<!-- -->. You get unlimited access to insightful stories from amazing thinkers and storytellers.<!-- --> <a href="https://medium.com/topic/members?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ca cb ov ow pe" rel="noopener">Browse</a></span></div></div></div><div class="n o ft"><a href="https://medium.com/?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx ot ou ca cb ov ow" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="oy"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="aq b ar as at au r pc pd"><div class="pg ph n ft pi an"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx gg ca cb ov ow" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx gg ca cb ov ow" rel="noopener">Help</a><a href="https://medium.com/policy/9db0094a1e0f?source=post_page-----40a16e134691----------------------" class="bo bp bq br bs bt bu bv bw bx gg ca cb ov ow" rel="noopener">Legal</a></div></span></div></section></div></div></div><script src="https://cdn.optimizely.com/js/16180790160.js"></script><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20200130-234604-6bc961fa6e","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20200130-234604-6bc961fa6e"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440}},"performanceTags":[]},"debug":{"requestId":"034cfcaa-9e2c-4bb1-a808-839b3d0e1f07","originalSpanCarrier":{"ot-tracer-spanid":"1a8fc4fb1d72eb52","ot-tracer-traceid":"1160084065c5fdda","ot-tracer-sampled":"true"}},"session":{"user":{"id":"dabfd9c69bfd"},"xsrf":"OASaLpjOk71E"},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hasRenderedBranchBanner":null,"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"branchData":{"loaded":false},"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fhigh-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691","host":"towardsdatascience.com","hostname":"towardsdatascience.com","susiModal":{"step":null,"operation":"register","reportEventInfo":{"eventName":"","data":{}}}},"client":{"isBot":false,"isEu":false,"isLinkedin":false,"isNativeMedium":false,"isCustomDomain":true},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"User:dabfd9c69bfd":{"id":"dabfd9c69bfd","username":"kevlo","name":"Kevin Lo","imageId":"","mediumMemberAt":1553422090311,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"goldtanks@gmail.com","unverifiedEmail":"","createdAt":1521952788047,"__typename":"User"},"ROOT_QUERY":{"viewer":{"type":"id","generated":false,"id":"User:dabfd9c69bfd","typename":"User"},"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.93","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.94","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.95","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.96","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.97","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.98","typename":"VariantFlag"}],"meterPost({\"postId\":\"40a16e134691\",\"postMeteringOptions\":{}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"40a16e134691\"})":{"type":"id","generated":false,"id":"Post:40a16e134691","typename":"Post"},"notificationsConnection({})":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({})","typename":"NotificationsConnection"},"notificationStatus":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationStatus","typename":"NotificationStatus"}},"ROOT_QUERY.variantFlags.0":{"name":"add_friction_to_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.3":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.4":{"name":"assign_default_topic_to_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.5":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.6":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.7":{"name":"branch_seo_metadata","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.9":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"enable_android_local_currency","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_auto_tier","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_daily_read_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_expanded_feature_chunk_pool","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_geolocation_stripe_standard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.35":{"name":"enable_json_logs_trained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_kbfd_rex","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_kbfd_rex_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_kbfd_rex_daily_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_lite_membership_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagString","value":"new-content"},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_lite_server_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_lo_meter_swap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_membership_thank_you_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_new_payout_system","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_new_pub_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_nonmember_reading_list_web","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_partner_dashboard_tax_withholding_updates","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_popularity_feature","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_post_seo_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_recently_viewed_tab_on_web","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_rito_caching","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_rito_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_sign_up_with_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_suggest_account","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"enable_suggest_account_li","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.82":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"enable_ticks_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.85":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.86":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.87":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.89":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.90":{"name":"is_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.91":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.92":{"name":"pardon_the_interruption_4","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.93":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.93.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.93.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.94":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.94.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.94.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.95":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.95.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.95.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.96":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.96.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.96.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.97":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.97.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.97.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.98":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.98.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.98.valueType":{"__typename":"VariantFlagBoolean","value":true},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:40a16e134691":{"__typename":"Post","visibility":"PUBLIC","latestPublishedVersion":"61c262513d47","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"id":"40a16e134691","creator":{"type":"id","generated":false,"id":"User:626db2fc9efe","typename":"User"},"isLocked":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","sequence":null,"mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fhigh-availability-mysql-cluster-with-load-balancing-using-haproxy-and-heartbeat-40a16e134691","canonicalUrl":"","content({\"postMeteringOptions\":{}})":{"type":"id","generated":true,"id":"$Post:40a16e134691.content({\"postMeteringOptions\":{}})","typename":"PostContent"},"firstPublishedAt":1543829373327,"isPublished":true,"layerCake":3,"primaryTopic":{"type":"id","generated":false,"id":"software-engineering","typename":"Topic"},"title":"High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":"APPROVED","readingTime":9.324528301886792,"readingList":"READING_LIST_QUEUE","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:mysql","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:heartbeat","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:haproxy","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:cluster","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:load-balancing","typename":"Tag"}],"viewerClapCount":0,"clapCount":364,"voterCount":112,"recommenders":[],"responsesCount":11,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"isDistributionAlertDismissed":false,"audioVersionUrl":"","seoTitle":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1558118726937,"previewContent":{"type":"id","generated":true,"id":"$Post:40a16e134691.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:1*-UDKtIOlY9KCgnT0iTIuCg.png","typename":"ImageMetadata"},"updatedAt":1558118727174,"topics":[{"type":"id","generated":false,"id":"software-engineering","typename":"Topic"},{"type":"id","generated":false,"id":"data-science","typename":"Topic"}],"seoDescription":"","isSuspended":false},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","domain":"towardsdatascience.com","slug":"towards-data-science","__typename":"Collection","auroraAlphaEnabled":false,"googleAnalyticsId":"UA-19707169-24","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","name":"Towards Data Science","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","typename":"ImageMetadata"},"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png","typename":"ImageMetadata"},"isEnrolledInHightower":false,"creator":{"type":"id","generated":false,"id":"User:895063a310f4","typename":"User"},"viewerIsEditor":false,"navItems":[{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.5","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.6","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.7","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette","typename":"ColorPalette"},"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"description":"A Medium publication sharing concepts, ideas, and codes.","viewerIsFollowing":true,"viewerIsSubscribedToLetters":false,"isUserSubscribedToCollectionEmails":true,"ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null,"favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png","typename":"ImageMetadata"}},"User:626db2fc9efe":{"id":"626db2fc9efe","__typename":"User","isSuspended":false,"allowNotes":true,"name":"Alexey Nizhegolenko","isFollowing":false,"username":"ratibor78","bio":"Sysadmin & DevOps Engineer in Internetvikings, Stockholm.","imageId":"1*aMCBXLrw-RxKEQCGpz5ihw.jpeg","mediumMemberAt":0,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":""},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","originalWidth":337,"originalHeight":122,"__typename":"ImageMetadata"},"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png":{"id":"1*hVxgUA6kP-PgL5TJjuyePg.png","__typename":"ImageMetadata"},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"Collection:7f60cf5620c9.navItems.0":{"title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.1":{"title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.2":{"title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.3":{"title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.4":{"title":"AI","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fartificial-intelligence\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.5":{"title":"Picks","url":"https:\u002F\u002Ftowardsdatascience.com\u002Four-picks\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.6":{"title":"More","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmore\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.7":{"title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF355876","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF355876","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF4D6C88","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF637F99","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF7791A8","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF8CA2B7","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF9FB3C6","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFB2C3D4","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFC5D2E1","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD7E2EE","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE9F1FA","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFFBFFFF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"},"highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum","typename":"ColorSpectrum"}},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF668AAA","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF61809D","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF5A7690","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF546C83","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF4D6275","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF455768","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF3D4C5A","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF34414C","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF2B353E","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF21282F","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF161B1F","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFEDF4FC","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE9F2FD","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFE6F1FD","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFE2EFFD","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFDFEEFD","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFDBECFE","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFD7EBFE","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFD4E9FE","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFD0E7FF","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFCCE6FF","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFC8E4FF","point":1,"__typename":"ColorPoint"},"$Post:40a16e134691.content({\"postMeteringOptions\":{}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:40a16e134691.content({\"postMeteringOptions\":{}}).bodyModel","typename":"RichText"}},"software-engineering":{"name":"Software Engineering","slug":"software-engineering","__typename":"Topic","isFollowing":null},"$Post:40a16e134691.content({\"postMeteringOptions\":{}}).bodyModel.sections.0":{"name":"d365","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:40a16e134691.content({\"postMeteringOptions\":{}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:40a16e134691.content({\"postMeteringOptions\":{}}).bodyModel.sections.0","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:61c262513d47_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_109","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_110","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_111","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_112","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_113","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_114","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_115","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_116","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_117","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_118","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_119","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_120","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_121","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_122","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_123","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_124","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_125","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_126","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_127","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_128","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_129","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_130","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_131","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_132","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_133","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_134","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_135","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_136","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_137","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_138","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_139","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_140","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_141","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_142","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_143","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_144","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:61c262513d47_145","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:61c262513d47_0":{"id":"61c262513d47_0","name":"8bd5","type":"H3","href":null,"layout":null,"metadata":null,"text":"High-Availability MySQL cluster with load balancing using HAProxy and Heartbeat.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_1":{"id":"61c262513d47_1","name":"f87e","type":"P","href":null,"layout":null,"metadata":null,"text":"Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes, with load balancing and failover capability based on HAProxy & Heartbeat.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_2":{"id":"61c262513d47_2","name":"4a3d","type":"P","href":null,"layout":null,"metadata":null,"text":"On most of modern projects, the database availability is a matter of life and death. Good solution will be creation a distributed database cluster, from more then one MySQL server, that can take care of load balancing, failover capabilities and data replication. Also, you can split an incoming requests and take care about high load.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_3":{"id":"61c262513d47_3","name":"c4b5","type":"P","href":null,"layout":null,"metadata":null,"text":"In this example I will show creating a MySQL cluster from two master nodes, main idea is to create a pair of servers with same configurations and one virtual IP for taking requests. This cluster will continue working even after totally losing one of the nodes.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_4":{"id":"61c262513d47_4","name":"2e22","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll use a two servers (virtual or bare metal) with pair of MySQL masters and a pair of HAProxy installed on them, the main virtual IP will be configured with Heartbeat. Please mind that in this example only one HAProxy be using in one time period, the second HAProxy will be standing in hot reserve. MySQL servers will be recycle with round robin type of load balancing.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_5":{"id":"61c262513d47_5","name":"0d6e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*-UDKtIOlY9KCgnT0iTIuCg.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-UDKtIOlY9KCgnT0iTIuCg.png":{"id":"1*-UDKtIOlY9KCgnT0iTIuCg.png","originalHeight":581,"originalWidth":721,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:61c262513d47_6":{"id":"61c262513d47_6","name":"8f05","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The schema with two servers was chosen for making an example simpler. Of course if you have an additional servers, you can create a more complicated configurations, putting HAProxy with Heartbeat in external LB cluster and so on. But anyway, this example will be a quite enough for building a strong looking DB cluster inside your project.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_7":{"id":"61c262513d47_7","name":"0394","type":"H4","href":null,"layout":null,"metadata":null,"text":"0. Preparing.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_7.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_7.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_8":{"id":"61c262513d47_8","name":"1a5b","type":"P","href":null,"layout":null,"metadata":null,"text":"First we’ll need to choose few subnets for the MySQL replications and for the HAProxy with Heartbeat, better separate them and if your server have a few network interface put these subnets on different interfaces as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_9":{"id":"61c262513d47_9","name":"546a","type":"P","href":null,"layout":null,"metadata":null,"text":"192.168.0.0\u002F24 - network for DB traffic","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_9.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_9.markups.0":{"type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_10":{"id":"61c262513d47_10","name":"c5f3","type":"P","href":null,"layout":null,"metadata":null,"text":"192.168.0.1 IP for MySQL1, 192.168.0.2 IP for MySQL2.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_10.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_10.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_10.markups.0":{"type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_10.markups.1":{"type":"STRONG","start":27,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_11":{"id":"61c262513d47_11","name":"c2c8","type":"P","href":null,"layout":null,"metadata":null,"text":"10.10.10.0\u002F24 - network for the Heartbeat & HAProxy.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_11.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_11.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_12":{"id":"61c262513d47_12","name":"679a","type":"P","href":null,"layout":null,"metadata":null,"text":"10.10.10.1 Virtual IP for taking requests, 10.10.10.2 main IP for sever1, 10.10.10.3 main IP for server2.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_12.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_12.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_12.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_12.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_12.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_12.markups.0":{"type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_12.markups.1":{"type":"STRONG","start":43,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_12.markups.2":{"type":"STRONG","start":66,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_12.markups.3":{"type":"STRONG","start":74,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_12.markups.4":{"type":"STRONG","start":97,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_13":{"id":"61c262513d47_13","name":"5268","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The \u002F29 subnets will be quite enough in fact :)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_14":{"id":"61c262513d47_14","name":"5ed9","type":"H4","href":null,"layout":null,"metadata":null,"text":"1. Configuring MySQL servers with master - master replication.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_14.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_14.markups.0":{"type":"STRONG","start":0,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_15":{"id":"61c262513d47_15","name":"6908","type":"P","href":null,"layout":null,"metadata":null,"text":"First we need to install MySQL on both of ours servers:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_16":{"id":"61c262513d47_16","name":"6e0f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# apt-get update && apt-get upgrade -y","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_16.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_16.markups.0":{"type":"CODE","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_17":{"id":"61c262513d47_17","name":"d938","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# apt-get install mysql-server mysql-client","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_17.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_17.markups.0":{"type":"CODE","start":0,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_18":{"id":"61c262513d47_18","name":"3646","type":"P","href":null,"layout":null,"metadata":null,"text":"Then edit the \u002Fetc\u002Fmysql\u002Fmy.cnf on first and second node, to enable replication between MySQL servers and make them use IPS from 192.168.0.0\u002F24 subnet:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_18.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_18.markups.0":{"type":"STRONG","start":14,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_19":{"id":"61c262513d47_19","name":"f86a","type":"P","href":null,"layout":null,"metadata":null,"text":"Server1 configuration.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_20":{"id":"61c262513d47_20","name":"174d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"[mysqld]","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_21":{"id":"61c262513d47_21","name":"501e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bind-address    = 192.168.0.1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_22":{"id":"61c262513d47_22","name":"cc64","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server_id           = 1\nlog_bin             = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-bin.log\nlog_bin_index       = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-bin.log.index\nrelay_log           = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-relay-bin\nrelay_log_index     = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-relay-bin.index\nexpire_logs_days    = 10\nmax_binlog_size     = 100M\nlog_slave_updates   = 1\nauto-increment-increment = 2\nauto-increment-offset = 1","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_22.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_22.markups.0":{"type":"CODE","start":0,"end":374,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_23":{"id":"61c262513d47_23","name":"f33a","type":"P","href":null,"layout":null,"metadata":null,"text":"Server2 configuration.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_24":{"id":"61c262513d47_24","name":"694b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"[mysqld]","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_25":{"id":"61c262513d47_25","name":"5125","type":"PRE","href":null,"layout":null,"metadata":null,"text":"bind-address    = 192.168.0.2","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_26":{"id":"61c262513d47_26","name":"7d71","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server_id           = 2\nlog_bin             = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-bin.log\nlog_bin_index       = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-bin.log.index\nrelay_log           = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-relay-bin\nrelay_log_index     = \u002Fvar\u002Flog\u002Fmysql\u002Fmysql-relay-bin.index\nexpire_logs_days    = 10\nmax_binlog_size     = 100M\nlog_slave_updates   = 1\nauto-increment-increment = 2\nauto-increment-offset = 2","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_26.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_26.markups.0":{"type":"CODE","start":0,"end":374,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_27":{"id":"61c262513d47_27","name":"2ec5","type":"P","href":null,"layout":null,"metadata":null,"text":"Then restart them both and make sure MySQL leaf on specified IP:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_28":{"id":"61c262513d47_28","name":"acf6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# systemctl restart mysql","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_29":{"id":"61c262513d47_29","name":"f80b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# netstat -ntlp","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_30":{"id":"61c262513d47_30","name":"1cc6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Active Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID\u002FProgram name    \ntcp        0      0 192.168.0.1:3306        0.0.0.0:*               LISTEN      9057\u002Fmysqld","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_31":{"id":"61c262513d47_31","name":"e6ac","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# systemctl restart mysql","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_32":{"id":"61c262513d47_32","name":"b106","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# netstat -ntlp","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_33":{"id":"61c262513d47_33","name":"a32a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Active Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID\u002FProgram name    \ntcp        0      0 192.168.0.2:3306        0.0.0.0:*               LISTEN      8740\u002Fmysqld","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_34":{"id":"61c262513d47_34","name":"29c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Now will create a user for replication between databases, you can use pwgen utility to generate strong enough password. Connect to each MySQL servers and create this user with IP from opposite server:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_34.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_34.markups.0":{"type":"STRONG","start":70,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_35":{"id":"61c262513d47_35","name":"7880","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_35.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_35.markups.0":{"type":"CODE","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_36":{"id":"61c262513d47_36","name":"64ef","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E GRANT REPLICATION SLAVE ON *.* TO 'replicauser'@'192.168.0.2' IDENTIFIED BY 'somestrongpassword';","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_36.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_36.markups.0":{"type":"CODE","start":9,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_37":{"id":"61c262513d47_37","name":"5de3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_37.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_37.markups.0":{"type":"CODE","start":9,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_38":{"id":"61c262513d47_38","name":"f964","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E GRANT REPLICATION SLAVE ON *.* TO 'replicauser'@'192.168.0.1' IDENTIFIED BY 'somestrongpassword';","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_38.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_38.markups.0":{"type":"CODE","start":86,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_39":{"id":"61c262513d47_39","name":"c4d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Check that replicauser have access for each MySQL server.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_39.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_39.markups.0":{"type":"STRONG","start":11,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_40":{"id":"61c262513d47_40","name":"b5d6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u replicauser -p -h 192.168.0.2\nEnter password: somestrongpassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nbla bla....","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_40.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_40.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_40.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_40.markups.0":{"type":"CODE","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_40.markups.1":{"type":"CODE","start":64,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_40.markups.2":{"type":"STRONG","start":142,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_41":{"id":"61c262513d47_41","name":"8008","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u replicauser -p -h 192.168.0.1\nEnter password: somestrongpassword\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nbla bla....","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_41.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_41.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_41.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_41.markups.0":{"type":"CODE","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_41.markups.1":{"type":"CODE","start":64,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_41.markups.2":{"type":"STRONG","start":142,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_42":{"id":"61c262513d47_42","name":"d0d1","type":"P","href":null,"layout":null,"metadata":null,"text":"Fine, now we can continue with configuring replication between MySQL servers. From that time better to have opened two consoles from both of MySQL servers, as we need to input commands, based on output from another server.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_43":{"id":"61c262513d47_43","name":"3580","type":"P","href":null,"layout":null,"metadata":null,"text":"Get the MySQL master status on server1:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_44":{"id":"61c262513d47_44","name":"35cc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_45":{"id":"61c262513d47_45","name":"3ce9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E SHOW MASTER STATUS;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_45.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_45.markups.0":{"type":"CODE","start":9,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_46":{"id":"61c262513d47_46","name":"9418","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+------------------+----------+--------------+------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |\n+------------------+----------+--------------+------------------+\n| mysql-bin.000002 |      531 |              |                  |\n+------------------+----------+--------------+------------------+\n1 row in set (0.00 sec)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_47":{"id":"61c262513d47_47","name":"40ac","type":"P","href":null,"layout":null,"metadata":null,"text":"We’ll need the File and Position information, from this output. Open the MySQL console on server2 and configure the slave relation with first server.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_47.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_47.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_47.markups.0":{"type":"STRONG","start":15,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_47.markups.1":{"type":"STRONG","start":24,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_48":{"id":"61c262513d47_48","name":"a98a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_49":{"id":"61c262513d47_49","name":"6922","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E STOP SLAVE;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_49.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_49.markups.0":{"type":"CODE","start":9,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_50":{"id":"61c262513d47_50","name":"78ed","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E CHANGE MASTER TO master_host='192.168.0.1', master_port=3306, master_user='replicauser', master_password='somestrongpassword', master_log_file='mysql-bin.000002', master_log_pos=531;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_50.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_50.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_50.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_50.markups.0":{"type":"CODE","start":9,"end":153,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_50.markups.1":{"type":"CODE","start":169,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_50.markups.2":{"type":"CODE","start":190,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_51":{"id":"61c262513d47_51","name":"bace","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E START SLAVE;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_51.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_51.markups.0":{"type":"CODE","start":9,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_52":{"id":"61c262513d47_52","name":"57ee","type":"P","href":null,"layout":null,"metadata":null,"text":"Now query the master status from server2 and configure slave relation for MySQL on first server.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_53":{"id":"61c262513d47_53","name":"bc8d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_54":{"id":"61c262513d47_54","name":"4d5c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E SHOW MASTER STATUS;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_54.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_54.markups.0":{"type":"CODE","start":9,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_55":{"id":"61c262513d47_55","name":"5028","type":"PRE","href":null,"layout":null,"metadata":null,"text":"+------------------+----------+--------------+------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB |\n+------------------+----------+--------------+------------------+\n| mysql-bin.000002 |      531 |              |                  |\n+------------------+----------+--------------+------------------+\n1 row in set (0.00 sec)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_56":{"id":"61c262513d47_56","name":"b96a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_57":{"id":"61c262513d47_57","name":"ef1e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E STOP SLAVE;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_57.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_57.markups.0":{"type":"CODE","start":9,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_58":{"id":"61c262513d47_58","name":"97ea","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E CHANGE MASTER TO master_host='192.168.0.2', master_port=3306, master_user='replicauser', master_password='somestrongpassword', master_log_file='mysql-bin.000002', master_log_pos=531;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_58.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_58.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_58.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_58.markups.0":{"type":"CODE","start":9,"end":153,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_58.markups.1":{"type":"CODE","start":169,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_58.markups.2":{"type":"CODE","start":190,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_59":{"id":"61c262513d47_59","name":"24e0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E START SLAVE;","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_59.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_59.markups.0":{"type":"CODE","start":9,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_60":{"id":"61c262513d47_60","name":"4d4d","type":"P","href":null,"layout":null,"metadata":null,"text":"OK, if all was done right, we must have a working replication between MySQL masters. You can create some test DB and check this.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_61":{"id":"61c262513d47_61","name":"a3a8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_62":{"id":"61c262513d47_62","name":"8130","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E CREATE DATABASE TESTDB;\nMariaDB\u003E CREATE TABLE TESTDB.REPLICA (`id` varchar(40));","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_62.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_62.markups.0":{"type":"CODE","start":42,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_63":{"id":"61c262513d47_63","name":"06d1","type":"P","href":null,"layout":null,"metadata":null,"text":"Then check this database was appeared on second server as well:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_64":{"id":"61c262513d47_64","name":"3f4e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_65":{"id":"61c262513d47_65","name":"9c2d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E SHOW TABLES IN TESTDB;\n+------------------+\n| Tables_in_TESTDB |\n+------------------+\n| REPLICA          |\n+------------------+\n1 row in set (0.00 sec)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_65.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_65.markups.0":{"type":"CODE","start":9,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_66":{"id":"61c262513d47_66","name":"4247","type":"P","href":null,"layout":null,"metadata":null,"text":"And as you can see, the TESTDB base was successfully replicated to server2. We just completed a first stage of creating our failover cluster.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_66.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_66.markups.0":{"type":"STRONG","start":24,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_67":{"id":"61c262513d47_67","name":"45be","type":"H4","href":null,"layout":null,"metadata":null,"text":"2. Configuring HAProxy on both servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_67.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_67.markups.0":{"type":"STRONG","start":3,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_68":{"id":"61c262513d47_68","name":"82eb","type":"P","href":null,"layout":null,"metadata":null,"text":"In second stage we’ll install and configure two absolutely identical HAProxy on both of our servers, for balancing a incoming requests between MySQL servers.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_69":{"id":"61c262513d47_69","name":"9f38","type":"P","href":null,"layout":null,"metadata":null,"text":"First we need to add additional user on our MySQL servers (user must be created without any password), this user will be used by HAProxy for checking a health status of MySQL servers.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_70":{"id":"61c262513d47_70","name":"f16f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_71":{"id":"61c262513d47_71","name":"b91d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E CREATE USER 'haproxy_check'@'%';\nMariaDB\u003E FLUSH PRIVILEGES;","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_72":{"id":"61c262513d47_72","name":"443b","type":"P","href":null,"layout":null,"metadata":null,"text":"You can create this user on any of our MySQL servers, as we have a replication configured between them. Check that user was added, using this command:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_73":{"id":"61c262513d47_73","name":"8bb8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p -e \"SELECT User, Host FROM mysql.user\"\nEnter password: \n+---------------+-------------+\n| User          | Host        |\n+---------------+-------------+\n| haproxy_check | %           |\n| replicauser   | 192.168.0.2 |\n| root          | localhost   |\n+---------------+-------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_74":{"id":"61c262513d47_74","name":"1768","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# mysql -u root -p -e \"SELECT User, Host FROM mysql.user\"\nEnter password: \n+---------------+-------------+\n| User          | Host        |\n+---------------+-------------+\n| haproxy_check | %           |\n| replicauser   | 192.168.0.1 |\n| root          | localhost   |\n+---------------+-------------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_75":{"id":"61c262513d47_75","name":"3dd3","type":"P","href":null,"layout":null,"metadata":null,"text":"Also let’s create a user with root privileges, for making some test requests later:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_76":{"id":"61c262513d47_76","name":"cf22","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mysql -u root -p","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_77":{"id":"61c262513d47_77","name":"ecff","type":"PRE","href":null,"layout":null,"metadata":null,"text":"MariaDB\u003E CREATE USER 'haproxy_root'@'%' IDENTIFIED BY 'password';\nMariaDB\u003E GRANT ALL PRIVILEGES ON *.* TO 'haproxy_root'@'%';","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_78":{"id":"61c262513d47_78","name":"d286","type":"P","href":null,"layout":null,"metadata":null,"text":"Now it’s time for HAProxy installation:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_79":{"id":"61c262513d47_79","name":"0556","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# apt-get install haproxy\nserver2# apt-get install haproxy","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_79.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_79.markups.0":{"type":"CODE","start":0,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_80":{"id":"61c262513d47_80","name":"4e7b","type":"P","href":null,"layout":null,"metadata":null,"text":"Save original config and create new one:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_81":{"id":"61c262513d47_81","name":"e3dc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# mv \u002Fetc\u002Fhaproxy\u002Fhaproxy.cfg{,.back}\nserver1# vi \u002Fetc\u002Fhaproxy\u002Fhaproxy.cfg","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_82":{"id":"61c262513d47_82","name":"d358","type":"P","href":null,"layout":null,"metadata":null,"text":"Next add this configuration on both servers:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_83":{"id":"61c262513d47_83","name":"1096","type":"PRE","href":null,"layout":null,"metadata":null,"text":"global\n    user haproxy\n    group haproxy","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_84":{"id":"61c262513d47_84","name":"b576","type":"PRE","href":null,"layout":null,"metadata":null,"text":"defaults\n    mode http\n    log global\n    retries 2\n    timeout connect 3000ms\n    timeout server 5000ms\n    timeout client 5000ms","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_85":{"id":"61c262513d47_85","name":"c8dc","type":"PRE","href":null,"layout":null,"metadata":null,"text":"listen stats\n    bind 10.10.10.1:9999\n    stats enable\n    stats hide-version\n    stats uri \u002Fstats\n    stats auth statadmin:statadminpass","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_86":{"id":"61c262513d47_86","name":"c4ea","type":"PRE","href":null,"layout":null,"metadata":null,"text":"listen mysql-cluster\n    bind 10.10.10.1:3306\n    mode tcp\n    option mysql-check user haproxy_check\n    balance roundrobin\n    server mysql-1 192.168.0.1:3306 check\n    server mysql-2 192.168.0.2:3306 check","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_87":{"id":"61c262513d47_87","name":"21e3","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, both HAProxy services will use 10.10.10.1, shared IP address. This virtual IP will move on between servers, so we need to make some trick and enable net.ipv4.ip_nonlocal_bind sysctl option, to allow system services binding on the non-local IP.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_87.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_87.markups.0":{"type":"STRONG","start":165,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_88":{"id":"61c262513d47_88","name":"09f2","type":"P","href":null,"layout":null,"metadata":null,"text":"Add to the file \u002Fetc\u002Fsysctl.conf this option:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_88.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_88.markups.0":{"type":"STRONG","start":16,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_89":{"id":"61c262513d47_89","name":"86e1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# vi \u002Fetc\u002Fsysctl.conf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_89.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_89.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_89.markups.0":{"type":"CODE","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_89.markups.1":{"type":"EM","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_90":{"id":"61c262513d47_90","name":"5c35","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net.ipv4.ip_nonlocal_bind=1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_91":{"id":"61c262513d47_91","name":"14b0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# vi \u002Fetc\u002Fsysctl.conf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_91.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_91.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_91.markups.0":{"type":"CODE","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_91.markups.1":{"type":"EM","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_92":{"id":"61c262513d47_92","name":"cb60","type":"PRE","href":null,"layout":null,"metadata":null,"text":"net.ipv4.ip_nonlocal_bind=1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_93":{"id":"61c262513d47_93","name":"a2a4","type":"P","href":null,"layout":null,"metadata":null,"text":"Then run","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_94":{"id":"61c262513d47_94","name":"0832","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sysctl -p","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_94.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_94.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_94.markups.0":{"type":"CODE","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_94.markups.1":{"type":"EM","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_95":{"id":"61c262513d47_95","name":"ce47","type":"P","href":null,"layout":null,"metadata":null,"text":"After this, we can start HAProxy on both servers:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_96":{"id":"61c262513d47_96","name":"d455","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# systemctl start haproxy\nserver2# systemctl start haproxy","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_97":{"id":"61c262513d47_97","name":"3eb3","type":"P","href":null,"layout":null,"metadata":null,"text":"Check they started on shared IP 10.10.10.1:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_98":{"id":"61c262513d47_98","name":"79a9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# netstat -ntlp ","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_99":{"id":"61c262513d47_99","name":"49f4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Active Internet connections (only servers) \nProto Recv-Q Send-Q Local Address Foreign Address State PID\u002FProgram name \ntcp 0 0 192.168.0.1:3306 0.0.0.0:* LISTEN 918\u002Fmysqld \ntcp 0 0 10.10.10.1:3306 0.0.0.0:* LISTEN 802\u002Fhaproxy \ntcp 0 0 10.10.10.1:9999 0.0.0.0:* LISTEN 802\u002Fhaproxy \ntcp 0 0 10.10.10.2:22 0.0.0.0:* LISTEN 785\u002Fsshd","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_100":{"id":"61c262513d47_100","name":"9fdf","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# netstat -ntlp","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_101":{"id":"61c262513d47_101","name":"0521","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Active Internet connections (only servers) \nProto Recv-Q Send-Q Local Address Foreign Address State PID\u002FProgram name \ntcp 0 0 192.168.0.2:3306 0.0.0.0:* LISTEN 918\u002Fmysqld \ntcp 0 0 10.10.10.1:3306 0.0.0.0:* LISTEN 802\u002Fhaproxy \ntcp 0 0 10.10.10.1:9999 0.0.0.0:* LISTEN 802\u002Fhaproxy \ntcp 0 0 10.10.10.3:22 0.0.0.0:* LISTEN 785\u002Fsshd","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_102":{"id":"61c262513d47_102","name":"ddcc","type":"P","href":null,"layout":null,"metadata":null,"text":"Everything look’s OK, both servers was started using virtual IP, also we configured a stats page on 9999 port, so you can check the HAProxy status on http:\u002F\u002F10.10.10.1:9999\u002Fstats using statadmin:statadminpass.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_102.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_102.markups.0":{"type":"A","start":150,"end":178,"href":"http:\u002F\u002F10.10.10.1:9999\u002Fstats","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_103":{"id":"61c262513d47_103","name":"cccb","type":"H4","href":null,"layout":null,"metadata":null,"text":"3. Configuring Heartbeat with shared IP.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_103.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_103.markups.0":{"type":"STRONG","start":3,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_104":{"id":"61c262513d47_104","name":"b155","type":"P","href":null,"layout":null,"metadata":null,"text":"On last stage we need to configure the Heartbeat service on both of the servers, and create shared IP, that will be used for serving incoming requests. This IP will migrate between servers if something wrong happens to one of them.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_105":{"id":"61c262513d47_105","name":"084b","type":"P","href":null,"layout":null,"metadata":null,"text":"Install Heartbeat on both servers:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_106":{"id":"61c262513d47_106","name":"8d0f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# apt-get install heartbeat\nserver1# systemctl enable heartbeat","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_107":{"id":"61c262513d47_107","name":"56ad","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# apt-get install heartbeat\nserver2# systemctl enable heartbeat","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_108":{"id":"61c262513d47_108","name":"d15a","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we need to create a few configuration files for it, they will be mostly the same for the server1 and server2.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_109":{"id":"61c262513d47_109","name":"58d0","type":"P","href":null,"layout":null,"metadata":null,"text":"Create a \u002Fetc\u002Fha.d\u002Fauthkeys, in this file Heartbeat stored data to authenticate each other. File will be the same on both servers:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_109.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_109.markups.0":{"type":"STRONG","start":9,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_110":{"id":"61c262513d47_110","name":"68b2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# vi \u002Fetc\u002Fha.d\u002Fauthkeys","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_111":{"id":"61c262513d47_111","name":"175e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auth 1\n1 md5 securepass","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_112":{"id":"61c262513d47_112","name":"4f1a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# vi \u002Fetc\u002Fha.d\u002Fauthkeys","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_113":{"id":"61c262513d47_113","name":"c028","type":"PRE","href":null,"layout":null,"metadata":null,"text":"auth 1\n1 md5 securepass","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_114":{"id":"61c262513d47_114","name":"af78","type":"P","href":null,"layout":null,"metadata":null,"text":"Change the securepass to your strong secure password. Also, this file need to be owned by root only, so:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_114.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_114.markups.0":{"type":"STRONG","start":11,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_115":{"id":"61c262513d47_115","name":"4300","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# chmod 600 \u002Fetc\u002Fha.d\u002Fauthkeys\nserver2# chmod 600 \u002Fetc\u002Fha.d\u002Fauthkeys","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_115.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_115.markups.0":{"type":"CODE","start":0,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_116":{"id":"61c262513d47_116","name":"c892","type":"P","href":null,"layout":null,"metadata":null,"text":"Next will create a main configuration for Heartbeat on both servers, it’ll be a bit different for server1 and server2, create \u002Fetc\u002Fha.d\u002Fha.cf:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_116.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_116.markups.0":{"type":"STRONG","start":126,"end":141,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_117":{"id":"61c262513d47_117","name":"2ce9","type":"P","href":null,"layout":null,"metadata":null,"text":"server1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_118":{"id":"61c262513d47_118","name":"c80b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# vi \u002Fetc\u002Fha.d\u002Fha.cf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_118.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_118.markups.0":{"type":"CODE","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_119":{"id":"61c262513d47_119","name":"78a7","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#       keepalive: how many seconds between heartbeats\n#\nkeepalive 2\n#\n#       deadtime: seconds-to-declare-host-dead\n#\ndeadtime 10\n#\n#       What UDP port to use for udp or ppp-udp communication?\n#\nudpport        694\nbcast  ens18\nmcast ens18 225.0.0.1 694 1 0\nucast ens18 10.10.10.3\n#       What interfaces to heartbeat over?\nudp     ens18\n#\n#       Facility to use for syslog()\u002Flogger (alternative to log\u002Fdebugfile)\n#\nlogfacility     local0\n#\n#       Tell what machines are in the cluster\n#       node    nodename ...    -- must match uname -n\nnode    server1\nnode    server2","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_120":{"id":"61c262513d47_120","name":"38a0","type":"P","href":null,"layout":null,"metadata":null,"text":"server2","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_121":{"id":"61c262513d47_121","name":"f424","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# vi \u002Fetc\u002Fha.d\u002Fha.cf","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_121.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_121.markups.0":{"type":"CODE","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_122":{"id":"61c262513d47_122","name":"453f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#       keepalive: how many seconds between heartbeats\n#\nkeepalive 2\n#\n#       deadtime: seconds-to-declare-host-dead\n#\ndeadtime 10\n#\n#       What UDP port to use for udp or ppp-udp communication?\n#\nudpport        694\nbcast  ens18\nmcast ens18 225.0.0.1 694 1 0\nucast ens18 10.10.10.2\n#       What interfaces to heartbeat over?\nudp     ens18\n#\n#       Facility to use for syslog()\u002Flogger (alternative to log\u002Fdebugfile)\n#\nlogfacility     local0\n#\n#       Tell what machines are in the cluster\n#       node    nodename ...    -- must match uname -n\nnode    server1\nnode    server2","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_123":{"id":"61c262513d47_123","name":"4448","type":"P","href":null,"layout":null,"metadata":null,"text":"The node names for this config you can get by running uname -n on your servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_123.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:61c262513d47_123.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_123.markups.0":{"type":"CODE","start":54,"end":62,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_123.markups.1":{"type":"STRONG","start":4,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_124":{"id":"61c262513d47_124","name":"95bf","type":"P","href":null,"layout":null,"metadata":null,"text":"And last we need to create the \u002Fetc\u002Fha.d\u002Fharesources file on server1 and server2. File be the same and in this file we’ll declare our shared IP address and master node by default:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:61c262513d47_124.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_124.markups.0":{"type":"STRONG","start":30,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:61c262513d47_125":{"id":"61c262513d47_125","name":"8850","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# vi \u002Fetc\u002Fha.d\u002Fharesources","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_126":{"id":"61c262513d47_126","name":"d963","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1 10.10.10.1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_127":{"id":"61c262513d47_127","name":"de0e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# vi \u002Fetc\u002Fha.d\u002Fharesources","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_128":{"id":"61c262513d47_128","name":"24cd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1 10.10.10.1","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_129":{"id":"61c262513d47_129","name":"3de5","type":"P","href":null,"layout":null,"metadata":null,"text":"After all let’s start our Heartbeat services on both servers, and you must see that on server1 we have the virtual IP up:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_130":{"id":"61c262513d47_130","name":"9e63","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server1# ip a \n....\n2: ens19: \u003CBROADCAST,MULTICAST,UP,LOWER_UP\u003E mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link\u002Fether bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff\n    inet 192.168.0.1\u002F24 brd 192.168.0.255 scope global ens19\n       valid_lft forever preferred_lft forever\n    inet6 fe80::bla:bla:bla:bla\u002F64 scope link \n       valid_lft forever preferred_lft forever\n3: ens18: \u003CBROADCAST,MULTICAST,UP,LOWER_UP\u003E mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link\u002Fether bla:bla:bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff\n    inet 10.10.10.2\u002F24 brd 10.10.10.255 scope global ens18\n       valid_lft forever preferred_lft forever\n    inet 10.10.10.1\u002F24 brd 10.10.10.255 scope global secondary \n....","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_131":{"id":"61c262513d47_131","name":"bf1b","type":"P","href":null,"layout":null,"metadata":null,"text":"OK, now we have virtual IP assigned on our server1 and HAProxy listening on it, so we can check how it works, making test requests. From some external server run this commands:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_132":{"id":"61c262513d47_132","name":"4a48","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# mysql -h 10.10.10.1 -u haproxy_root -p -e \"show variables like 'server_id'\"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_133":{"id":"61c262513d47_133","name":"7cca","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Enter password: \n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| server_id     | 1     |\n+---------------+-------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_134":{"id":"61c262513d47_134","name":"ba06","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# mysql -h 10.10.10.1 -u haproxy_root -p -e \"show variables like 'server_id'\"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_135":{"id":"61c262513d47_135","name":"5c38","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Enter password: \n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| server_id     | 2     |\n+---------------+-------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_136":{"id":"61c262513d47_136","name":"9ae5","type":"P","href":null,"layout":null,"metadata":null,"text":"All working fine, you can see the “round robin” balancing between our MySQL servers. Now we need to check the failover when the server1 will go offline for example. Go and restart or shutdown the server1, and check that virtual IP was moved to server2 and requests to the MySQL servers still OK, but now there is only MySQL on server2 will respond:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_137":{"id":"61c262513d47_137","name":"0e1a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"server2# ip a \n....\n2: ens19: \u003CBROADCAST,MULTICAST,UP,LOWER_UP\u003E mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link\u002Fether bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff\n    inet 192.168.0.2\u002F24 brd 192.168.0.255 scope global ens19\n       valid_lft forever preferred_lft forever\n    inet6 fe80::bla:bla:bla:bla\u002F64 scope link \n       valid_lft forever preferred_lft forever\n3: ens18: \u003CBROADCAST,MULTICAST,UP,LOWER_UP\u003E mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link\u002Fether bla:bla:bla:bla:bla:bla brd ff:ff:ff:ff:ff:ff\n    inet 10.10.10.3\u002F24 brd 10.10.10.255 scope global ens18\n       valid_lft forever preferred_lft forever\n    inet 10.10.10.1\u002F24 brd 10.10.10.255 scope global secondary \n....","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_138":{"id":"61c262513d47_138","name":"78cd","type":"P","href":null,"layout":null,"metadata":null,"text":"Check MySQL requests again:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_139":{"id":"61c262513d47_139","name":"08c1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# mysql -h 10.10.10.1 -u haproxy_root -p -e \"show variables like 'server_id'\"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_140":{"id":"61c262513d47_140","name":"37fe","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Enter password: \n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| server_id     | 2     |\n+---------------+-------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_141":{"id":"61c262513d47_141","name":"ddb1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# mysql -h 10.10.10.1 -u haproxy_root -p -e \"show variables like 'server_id'\"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_142":{"id":"61c262513d47_142","name":"0829","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Enter password: \n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| server_id     | 2     |\n+---------------+-------+","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_143":{"id":"61c262513d47_143","name":"2412","type":"P","href":null,"layout":null,"metadata":null,"text":"After the server1 will return online, the virtual IP will be moved back to it.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_144":{"id":"61c262513d47_144","name":"a3b4","type":"P","href":null,"layout":null,"metadata":null,"text":"And we did, we just configured and tested our MySQL cluster, and it now readies to serve requests.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:61c262513d47_145":{"id":"61c262513d47_145","name":"d7e0","type":"P","href":null,"layout":null,"metadata":null,"text":"Good luck.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Tag:mysql":{"id":"mysql","displayTitle":"MySQL","__typename":"Tag"},"Tag:heartbeat":{"id":"heartbeat","displayTitle":"Heartbeat","__typename":"Tag"},"Tag:haproxy":{"id":"haproxy","displayTitle":"Haproxy","__typename":"Tag"},"Tag:cluster":{"id":"cluster","displayTitle":"Cluster","__typename":"Tag"},"Tag:load-balancing":{"id":"load-balancing","displayTitle":"Load Balancing","__typename":"Tag"},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"$Post:40a16e134691.previewContent":{"subtitle":"Hello, in this article I wanna share some experience of building a high available MySQL database cluster, from two master MySQL nodes…","__typename":"PreviewContent"},"data-science":{"name":"Data Science","slug":"data-science","__typename":"Topic"},"$ROOT_QUERY.notificationsConnection({}).notifications.0":{"notificationType":"users_following_you","occurredAt":1571806471302,"isUnread":false,"post":null,"actor":{"type":"id","generated":false,"id":"User:f16c066f31b0","typename":"User"},"quote":null,"rollupItems":[],"__typename":"Notification","responsePost":null,"collection":null,"note":null,"noteReply":null,"milestoneArg":0},"User:f16c066f31b0":{"id":"f16c066f31b0","name":"Ragunath Rajasekaran","__typename":"User","username":"ragunathrajasekaran","imageId":"0*hVL0_V1JjIs3mAOy.jpg","mediumMemberAt":1559058241896},"$ROOT_QUERY.notificationsConnection({})":{"notifications":[{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.0","typename":"Notification"}],"pagingInfo":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo","typename":"Paging"},"__typename":"NotificationsConnection"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo.next":{"limit":25,"page":null,"source":null,"to":"1571806471301","__typename":"PageParams"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo":{"next":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo.next","typename":"PageParams"},"__typename":"Paging"},"$ROOT_QUERY.notificationStatus":{"unreadNotificationCount":0,"__typename":"NotificationStatus"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.0e013769.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~main.a133fb80.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.9846cc93.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~scre~3e410f11.d2f0cb5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~screen.post~~4767c889.764d541b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.collection.packageBuilder~screen.landingpages.pres45~screen.landingpages.tribute~screen.post~~73c4bb05.f979e7e3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post~screen.post.amp~screen.profile~screen.sequence.library~screen.sequence.post~screen.stori~aba94ffa.b52d2855.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/screen.post.45b0c6ba.chunk.js"></script><script>window.main();</script></body></html>